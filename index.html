<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Basic PWA and SEO Information -->
    <title>Travel Checklist</title>
    <meta name="description" content="Your personal travel checklist - never forget anything again!">
    
    <!--
      SECTION: PWA Manifest and Theme
    -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6366f1"> <!-- Purple theme color -->

    <!--
      SECTION: iOS Specific Meta Tags
      These are crucial for the "Add to Home Screen" experience on Apple devices.
    -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Travel Checklist">

    <!-- Apple Touch Icons (for the home screen icon) -->
    <!-- Provide different sizes for different devices -->
    <link rel="apple-touch-icon" href="./apple-touch-icon-120x120.png" sizes="120x120">
    <link rel="apple-touch-icon" href="./apple-touch-icon-152x152.png" sizes="152x152">
    <link rel="apple-touch-icon" href="./apple-touch-icon-180x180.png" sizes="180x180">
    
    <!--
      SECTION: Styling
    -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style for when the app is launched in standalone mode */
        @media all and (display-mode: standalone) {
            body {
                /* Add padding to avoid content overlapping with system UI like the notch or dynamic island */
                padding-top: env(safe-area-inset-top);
                padding-bottom: env(safe-area-inset-bottom);
                padding-left: env(safe-area-inset-left);
                padding-right: env(safe-area-inset-right);
            }
        }
        
        .checklist-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 8px;
            border: 2px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        
        .checklist-item.completed {
            background: #f0fdf4;
            border-color: #10b981;
            opacity: 0.7;
        }
        
        .checklist-item input[type="checkbox"] {
            margin-right: 12px;
            transform: scale(1.2);
        }
        
        .checklist-item.completed .item-text {
            text-decoration: line-through;
            color: #6b7280;
        }
        
        .category-header {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            padding: 12px 16px;
            margin: 16px 0 8px 0;
            border-radius: 8px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin: 16px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #059669);
            transition: width 0.5s ease;
        }
        
        .add-item-form {
            display: flex;
            margin: 12px 0;
            gap: 8px;
        }
        
        .add-item-input {
            flex: 1;
            padding: 8px 12px;
            border: 2px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .add-item-btn {
            background: #6366f1;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            background: #f8fafc;
            padding: 16px;
            border-radius: 8px;
            margin: 16px 0;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #6366f1;
        }
        
        .stat-label {
            font-size: 12px;
            color: #6b7280;
            text-transform: uppercase;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">

    <div class="max-w-md mx-auto bg-white shadow-2xl min-h-screen">
        <!-- Header -->
        <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6">
            <h1 class="text-2xl font-bold flex items-center">
                ‚úàÔ∏è Travel Checklist
            </h1>
            <p class="text-blue-100 text-sm mt-1">Never forget anything again!</p>
        </div>

        <!-- Progress Section -->
        <div class="p-4">
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 0%"></div>
            </div>
            
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number" id="completedCount">0</div>
                    <div class="stat-label">Completed</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalCount">0</div>
                    <div class="stat-label">Total Items</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="progressPercent">0%</div>
                    <div class="stat-label">Progress</div>
                </div>
            </div>
        </div>

        <!-- Checklist Content -->
        <div id="checklistContainer" class="px-4 pb-6">
            <!-- Categories will be dynamically added here -->
        </div>

        <!-- Action Buttons -->
        <div class="fixed bottom-4 right-4 space-y-2">
            <button id="addCategoryBtn" 
                    class="bg-purple-600 hover:bg-purple-700 text-white p-3 rounded-full shadow-lg transition-colors">
                üìÅ Add Category
            </button>
            <button id="resetBtn" 
                    class="bg-red-600 hover:bg-red-700 text-white p-3 rounded-full shadow-lg transition-colors">
                üîÑ Reset All
            </button>
        </div>

        <!-- Install Instructions -->
        <div class="mx-4 mb-4 p-4 bg-blue-50 rounded-lg">
            <p class="text-sm text-blue-700">
                üí° <strong>Install this app:</strong> Tap the Share icon and select 'Add to Home Screen'
            </p>
        </div>
    </div>

    <script>
        // Travel checklist data structure
        let checklistData = {
            categories: [
                {
                    id: 'documents',
                    name: 'üìÑ Documents & Money',
                    emoji: 'üìÑ',
                    items: [
                        { id: 1, text: 'Passport/ID', completed: false },
                        { id: 2, text: 'Flight tickets', completed: false },
                        { id: 3, text: 'Hotel confirmations', completed: false },
                        { id: 4, text: 'Travel insurance', completed: false },
                        { id: 5, text: 'Credit cards', completed: false },
                        { id: 6, text: 'Cash/local currency', completed: false }
                    ]
                },
                {
                    id: 'clothing',
                    name: 'üëï Clothing',
                    emoji: 'üëï',
                    items: [
                        { id: 7, text: 'Underwear', completed: false },
                        { id: 8, text: 'Socks', completed: false },
                        { id: 9, text: 'T-shirts/shirts', completed: false },
                        { id: 10, text: 'Pants/shorts', completed: false },
                        { id: 11, text: 'Jacket/sweater', completed: false },
                        { id: 12, text: 'Sleepwear', completed: false },
                        { id: 13, text: 'Comfortable shoes', completed: false }
                    ]
                },
                {
                    id: 'electronics',
                    name: 'üîå Electronics',
                    emoji: 'üîå',
                    items: [
                        { id: 14, text: 'Phone charger', completed: false },
                        { id: 15, text: 'Power bank', completed: false },
                        { id: 16, text: 'Camera', completed: false },
                        { id: 17, text: 'Headphones', completed: false },
                        { id: 18, text: 'Travel adapter', completed: false }
                    ]
                },
                {
                    id: 'toiletries',
                    name: 'üß¥ Toiletries & Health',
                    emoji: 'üß¥',
                    items: [
                        { id: 19, text: 'Toothbrush & toothpaste', completed: false },
                        { id: 20, text: 'Shampoo/soap', completed: false },
                        { id: 21, text: 'Medications', completed: false },
                        { id: 22, text: 'Sunscreen', completed: false },
                        { id: 23, text: 'First aid kit', completed: false }
                    ]
                }
            ]
        };

        // Load data from localStorage
        function loadData() {
            const saved = localStorage.getItem('travelChecklistData');
            if (saved) {
                checklistData = JSON.parse(saved);
            }
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('travelChecklistData', JSON.stringify(checklistData));
        }

        // Calculate progress
        function calculateProgress() {
            let totalItems = 0;
            let completedItems = 0;

            checklistData.categories.forEach(category => {
                totalItems += category.items.length;
                completedItems += category.items.filter(item => item.completed).length;
            });

            return { totalItems, completedItems };
        }

        // Update progress display
        function updateProgress() {
            const { totalItems, completedItems } = calculateProgress();
            const percentage = totalItems > 0 ? Math.round((completedItems / totalItems) * 100) : 0;

            document.getElementById('completedCount').textContent = completedItems;
            document.getElementById('totalCount').textContent = totalItems;
            document.getElementById('progressPercent').textContent = percentage + '%';
            document.getElementById('progressBar').style.width = percentage + '%';
        }

        // Create checklist item HTML
        function createChecklistItem(item, categoryId) {
            return `
                <div class="checklist-item ${item.completed ? 'completed' : ''}" data-item-id="${item.id}">
                    <input type="checkbox" ${item.completed ? 'checked' : ''} 
                           onchange="toggleItem(${item.id}, '${categoryId}')">
                    <span class="item-text flex-1">${item.text}</span>
                    <button onclick="deleteItem(${item.id}, '${categoryId}')" 
                            class="text-red-500 hover:text-red-700 ml-2">üóëÔ∏è</button>
                </div>
            `;
        }

        // Create category HTML
        function createCategory(category) {
            const completedCount = category.items.filter(item => item.completed).length;
            const totalCount = category.items.length;
            
            return `
                <div class="category" data-category-id="${category.id}">
                    <div class="category-header">
                        <span>${category.name}</span>
                        <span class="text-sm">${completedCount}/${totalCount}</span>
                    </div>
                    
                    <div class="add-item-form">
                        <input type="text" class="add-item-input" placeholder="Add new item..." 
                               onkeypress="handleAddItem(event, '${category.id}')">
                        <button class="add-item-btn" onclick="addItem('${category.id}')">Add</button>
                    </div>
                    
                    <div class="category-items">
                        ${category.items.map(item => createChecklistItem(item, category.id)).join('')}
                    </div>
                </div>
            `;
        }

        // Render entire checklist
        function renderChecklist() {
            const container = document.getElementById('checklistContainer');
            container.innerHTML = checklistData.categories.map(createCategory).join('');
            updateProgress();
        }

        // Toggle item completion
        function toggleItem(itemId, categoryId) {
            const category = checklistData.categories.find(cat => cat.id === categoryId);
            const item = category.items.find(item => item.id === itemId);
            item.completed = !item.completed;
            
            saveData();
            renderChecklist();
        }

        // Add new item
        function addItem(categoryId) {
            const category = checklistData.categories.find(cat => cat.id === categoryId);
            const input = document.querySelector(`[data-category-id="${categoryId}"] .add-item-input`);
            const text = input.value.trim();
            
            if (text) {
                const newId = Math.max(...checklistData.categories.flatMap(cat => cat.items.map(item => item.id))) + 1;
                category.items.push({
                    id: newId,
                    text: text,
                    completed: false
                });
                
                input.value = '';
                saveData();
                renderChecklist();
            }
        }

        // Handle Enter key in add item input
        function handleAddItem(event, categoryId) {
            if (event.key === 'Enter') {
                addItem(categoryId);
            }
        }

        // Delete item
        function deleteItem(itemId, categoryId) {
            if (confirm('Delete this item?')) {
                const category = checklistData.categories.find(cat => cat.id === categoryId);
                category.items = category.items.filter(item => item.id !== itemId);
                
                saveData();
                renderChecklist();
            }
        }

        // Add new category
        function addCategory() {
            const name = prompt('Enter category name:');
            if (name) {
                const emoji = prompt('Enter emoji for category (optional):') || 'üìã';
                const id = name.toLowerCase().replace(/[^a-z0-9]/g, '');
                
                checklistData.categories.push({
                    id: id,
                    name: `${emoji} ${name}`,
                    emoji: emoji,
                    items: []
                });
                
                saveData();
                renderChecklist();
            }
        }

        // Reset all items
        function resetAll() {
            if (confirm('Reset all items? This will uncheck everything but keep your list.')) {
                checklistData.categories.forEach(category => {
                    category.items.forEach(item => {
                        item.completed = false;
                    });
                });
                
                saveData();
                renderChecklist();
            }
        }

        // Event listeners
        document.getElementById('addCategoryBtn').addEventListener('click', addCategory);
        document.getElementById('resetBtn').addEventListener('click', resetAll);

        // Initialize app
        loadData();
        renderChecklist();

        // Register the Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registered successfully:', registration);
                    })
                    .catch(error => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
